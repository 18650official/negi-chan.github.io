<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>关于智能可穿戴设备研究计划的初步设想 | 葱酱的幻想乡 - Snowmiku's Dreamland</title><meta name="author" content="Snowmiku"><meta name="copyright" content="Snowmiku"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="本文介绍了葱酱即将接手的智能穿戴设备项目的初期规划，旨在设计一款可测量人体运动数据（如计步、爬楼高度等）并用于出口的类Apple Watch产品，涵盖需求分析与技术思路。">
<meta property="og:type" content="article">
<meta property="og:title" content="关于智能可穿戴设备研究计划的初步设想">
<meta property="og:url" content="http://snowmiku-home.top/2025/10/14/post-20251014/index.html">
<meta property="og:site_name" content="葱酱的幻想乡 - Snowmiku&#39;s Dreamland">
<meta property="og:description" content="本文介绍了葱酱即将接手的智能穿戴设备项目的初期规划，旨在设计一款可测量人体运动数据（如计步、爬楼高度等）并用于出口的类Apple Watch产品，涵盖需求分析与技术思路。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://snowmiku-home.top/images/icon2.jpg">
<meta property="article:published_time" content="2025-10-14T10:06:32.000Z">
<meta property="article:modified_time" content="2025-10-15T13:39:34.534Z">
<meta property="article:author" content="Snowmiku">
<meta property="article:tag" content="IoT">
<meta property="article:tag" content="BLE">
<meta property="article:tag" content="nRF52">
<meta property="article:tag" content="Smart Wear">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://snowmiku-home.top/images/icon2.jpg"><link rel="shortcut icon" href="/images/icon_small.png"><link rel="canonical" href="http://snowmiku-home.top/2025/10/14/post-20251014/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":true,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '关于智能可穿戴设备研究计划的初步设想',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-10-15 21:39:34'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><!-- require APlayer --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><!-- require MetingJS --><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script><style type="text/css">#toggle-sidebar {bottom: 80px}</style><style type="text/css">#toggle-sidebar {bottom: 80px}</style><style type="text/css"> #universe {  display: block; position: fixed; margin: 0; padding: 0; border: 0; outline: 0; left: 0; top: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1; } </style><meta name="generator" content="Hexo 7.2.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/images/icon2.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">34</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-folder-open"></i><span> 资源</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐库</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://www.snowmiku-drive.top/"><i class="fa-fw fas fa-folder"></i><span> 下载站</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-heart"></i><span> 更多信息</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/2024/06/01/about/author-intro/author-intro/"><i class="fa-fw fa fa-address-card"></i><span> 关于我</span></a></li><li><a class="site-page child" href="/friends"><i class="fa-fw fa fa-link"></i><span> 友情链接</span></a></li><li><a class="site-page child" href="/contact"><i class="fa-fw fa fa-handshake"></i><span> 联系和赞助</span></a></li><li><a class="site-page child" href="/update_log"><i class="fa-fw fa fa-file-text"></i><span> 更新日志</span></a></li><li><a class="site-page child" href="/Transgender-Site"><i class="fa-fw fa fa-transgender-alt"></i><span> 里站</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/images/title_miku1.png')"><nav id="nav"><span id="blog-info"><a href="/" title="葱酱的幻想乡 - Snowmiku's Dreamland"><img class="site-icon" src="/images/icon.jpg"/><span class="site-name">葱酱的幻想乡 - Snowmiku's Dreamland</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-folder-open"></i><span> 资源</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐库</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://www.snowmiku-drive.top/"><i class="fa-fw fas fa-folder"></i><span> 下载站</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-heart"></i><span> 更多信息</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/2024/06/01/about/author-intro/author-intro/"><i class="fa-fw fa fa-address-card"></i><span> 关于我</span></a></li><li><a class="site-page child" href="/friends"><i class="fa-fw fa fa-link"></i><span> 友情链接</span></a></li><li><a class="site-page child" href="/contact"><i class="fa-fw fa fa-handshake"></i><span> 联系和赞助</span></a></li><li><a class="site-page child" href="/update_log"><i class="fa-fw fa fa-file-text"></i><span> 更新日志</span></a></li><li><a class="site-page child" href="/Transgender-Site"><i class="fa-fw fa fa-transgender-alt"></i><span> 里站</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">关于智能可穿戴设备研究计划的初步设想</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-10-14T10:06:32.000Z" title="发表于 2025-10-14 18:06:32">2025-10-14</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-10-15T13:39:34.534Z" title="更新于 2025-10-15 21:39:34">2025-10-15</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">8.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>25分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="关于智能可穿戴设备研究计划的初步设想"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2025/10/14/post-20251014/#post-comment"><span id="twikoo-count"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>本文介绍了葱酱即将接手的智能穿戴设备项目的初期规划，旨在设计一款可测量人体运动数据（如计步、爬楼高度等）并用于出口的类Apple Watch产品，涵盖需求分析与技术思路。</p>
<span id="more"></span>

<p><meting-js
    name="朗读"
    artist="Azure"
    url="/audio/post-20251014.wav"
    cover="https://snowmiku-blog-1326916956.cos.ap-hongkong.myqcloud.com/Screenshot_2024-08-15-00-35-26-521_com.tencent.mm.jpg?imageSlim"
    fixed="false"><br></meting-js></p>
<h1 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h1><p>这个帖子是对葱酱可能即将接手的正式项目——一个带有身体与运动数据检测功能的智能穿戴设备的初期规划与思考，为了快速且高效的整理和呈现我的思路，我把这个初期研究整理成一篇技术报告类的Post，也希望这个项目可以顺利进行。</p>
<h1 id="需求分析"><a href="#需求分析" class="headerlink" title="需求分析"></a>需求分析</h1><p>项目目前处在未启动和规划阶段，通过与研究团队的交流，我对整个项目有了一个整体化的了解：</p>
<h2 id="项目产品概述"><a href="#项目产品概述" class="headerlink" title="项目产品概述"></a>项目产品概述</h2><p>项目的目的是设计一款用于出口的智能穿戴设备，这款设备可以像苹果Apple Watch一样穿戴在手腕上，可以测量一些人体数据（包含了计步器、爬楼高度等运动数据和心率、血压血氧等生物学数据，并且可以实时通过无线电（Wi-Fi或者BLE）传输到移动设备，最终需要传输到云端服务器。</p>
<h2 id="研究的重点"><a href="#研究的重点" class="headerlink" title="研究的重点"></a>研究的重点</h2><p>此项目的研究有一些需要关注的重点，我将在文章中对这些要点做出我的初步规划和思考，并且在后续的研究中逐步跟进：</p>
<ul>
<li>选择的芯片方案、通信技术和传感器方案</li>
<li>选择的电池方案：需要保证在1min&#x2F;次更新的情况下，实现5天以上的待机时间</li>
<li><strong>如何解决毛发遮挡光学传感器的问题</strong></li>
<li>如何设计产品外形，如何呈现不同阶段的设计成品</li>
<li>PCB与电路细节设计中，需要考虑哪些设计问题</li>
<li>在设计的后期，研发团队计划加入Solar Panel充电功能，如何在有限空间内得以实现</li>
</ul>
<h1 id="细节思考：对研究重点的展开"><a href="#细节思考：对研究重点的展开" class="headerlink" title="细节思考：对研究重点的展开"></a>细节思考：对研究重点的展开</h1><p>下面，我将从上面列出的研究重点展开，给出我的调研与思考：</p>
<h2 id="芯片、通讯方案"><a href="#芯片、通讯方案" class="headerlink" title="芯片、通讯方案"></a>芯片、通讯方案</h2><p>本产品需要一款 <strong>低功耗、支持无线通信技术</strong>的微控制器。对于一个后续需要投入商业使用的设备，芯片的选择还需要：</p>
<ul>
<li>文档齐全、开发工具成熟</li>
<li>可配置性高、例程与开发生态丰富</li>
<li>集成度高，环境易于上手开发与详细调试</li>
<li>低功耗方面经得住考验，有足够的可靠和稳定性</li>
</ul>
<p>经过资料查阅与调研，我希望使用<strong>Nordic Semiconductor nRF52 系列</strong>，具体芯片型号为<code>nRF52840 / nRF52833</code>，这是一颗集成的、专注于BLE的片上系统（SoC），且计划使用低功耗蓝牙（BLE）进行通信。</p>
<p><strong>选择理由：</strong></p>
<ol>
<li><strong>极致的功耗表现：</strong> Nordic 在低功耗无线通信领域是业界的标杆。nRF52 系列拥有非常灵活的电源管理系统，可以让芯片在绝大多数时间处于微安（µA）级别的深度睡眠模式，仅在需要采集和传输数据时才被唤醒。这是实现「5天以上待机时间」的硬件基础。</li>
<li><strong>强大的处理性能：</strong> 该系列芯片搭载了带有浮点运算单元（FPU）的 ARM Cortex-M4F 内核。这个浮点运算单元（FPU）至关重要，因为后续要解决毛发干扰问题，必然会涉及到大量的<strong>滤波、插值等数字信号处理（DSP）算法</strong>，FPU可以让这些运算快上数十倍，从而更快地完成计算并让芯片回到睡眠模式，进一步降低功耗。</li>
<li><strong>成熟稳定的开发生态：</strong> Nordic 提供了极其完善的 <strong>nRF Connect SDK</strong> 开发套件，该套件基于 <strong>Zephyr RTOS</strong>，提供了稳定的蓝牙5.x协议栈、丰富的驱动程序和大量的示例代码。完善的官方文档和活跃的开发者社区可以极大地缩短开发周期，降低开发风险。</li>
<li><strong>丰富的周边接口：</strong> 芯片内置了高品质的ADC、SPI、I2C、UART等接口，足以连接市面上所有的主流传感器。其中nRF52840还内置了USB控制器，方便在开发阶段进行日志打印和充电管理。</li>
</ol>
<h2 id="传感器方案"><a href="#传感器方案" class="headerlink" title="传感器方案"></a>传感器方案</h2><h3 id="传感器市场分析和初步选型"><a href="#传感器市场分析和初步选型" class="headerlink" title="传感器市场分析和初步选型"></a>传感器市场分析和初步选型</h3><p>传感器的选择直接决定了数据的原始品质。我们需要选择体积小、功耗低且信噪比（SNR）高的型号。</p>
<ul>
<li><p><strong>运动传感器 (计步器、爬楼高度)：</strong></p>
<ul>
<li><strong>推荐方案：</strong> 一颗六轴惯性测量单元 (IMU) <strong>Bosch BMI270</strong> + 一颗气压计 <strong>Bosch BMP390</strong>。</li>
<li><strong>选择理由：</strong><ol>
<li><strong>高集成度与低功耗：</strong> BMI270 集成了三轴加速度计和三轴陀螺仪，体积极小，其内置的计步器算法可以在极低的功耗下运行，无需持续唤醒主控MCU。</li>
<li><strong>高精度：</strong> BMP390 是目前市面上最精准的气压计之一，能侦测到极其微小的气压变化，这对于准确计算爬楼层数至关重要。</li>
</ol>
</li>
</ul>
</li>
<li><p><strong>生物传感器 (心率、血氧、血压趋势)：</strong></p>
<ul>
<li><p><strong>推荐方案：</strong> 一颗高集成度的光学模拟前端 (AFE) 芯片，例如 <strong>Maxim Integrated (已被ADI收购) 的 MAX86150</strong> 或 <strong>Analog Devices 的 ADPD4100</strong>。</p>
<blockquote>
<p>经过市场调查，在消费电子领域，<strong>MAX30102&#x2F;100</strong>有较为广泛的应用，且价格低廉，但考虑到后续成品中需要较高的SNR与抗环境光能力，我目前希望成品中使用专业、精度高的MAX86150方案，若对价格方面敏感，此项选型方案需后续商定。（MAX86150的零售采购价格在60-80元人民之间。）</p>
</blockquote>
</li>
<li><p><strong>选择理由：</strong></p>
<ol>
<li><strong>高信噪比 (High SNR)：</strong> 这是<strong>解决毛发遮挡问题的基础</strong>。专业的AFE芯片相比于简单的光电二极管+放大器方案，拥有更强的噪声抑制能力，能从微弱的反射光中提取出更干净的PPG信号。</li>
<li><strong>高集成度与灵活性：</strong> MAX86150 同时集成了PPG和心电图(ECG)的测量通道。这为未来通过PPG+ECG结合的方式（计算脉搏波传导时间 PTT）来实现更精准的血压趋势追踪提供了可能性。</li>
<li><strong>高度可配置性：</strong> 这类AFE芯片允许你通过代码精细地控制LED的驱动电流、采样率、积分时间等参数。这意味着你可以开发算法，在侦测到信号品质不佳时（例如因为毛发遮挡），<strong>动态地增强LED的发射功率</strong>，从硬件层面改善信号品质。</li>
</ol>
</li>
</ul>
</li>
</ul>
<h3 id="传感器的拓展功能"><a href="#传感器的拓展功能" class="headerlink" title="传感器的拓展功能"></a>传感器的拓展功能</h3><p>在初步确定了传感器的选型方案之后，我进行了一些延伸思考，基于上述的传感器，在分析了它们的工作原理之后，结合目前智能穿戴设备的应用场景，我拟定了几个在后续开发进程中可能添加的功能。</p>
<h4 id="3轴加速度传感器"><a href="#3轴加速度传感器" class="headerlink" title="3轴加速度传感器"></a>3轴加速度传感器</h4><ul>
<li><strong>实现的基础功能:</strong> 计步器。</li>
<li><strong>工作原理:</strong><br>  传感器内部有一个微机电结构（MEMS），可以想象成一个悬挂在微小弹簧上的重块。当你运动时，由于惯性，这个重块会相对于芯片发生位移。传感器通过测量这个位移导致的电容变化，将其转换为X、Y、Z三个轴向上的加速度数据。<br>  在行走或跑步时，身体会产生一种有规律的、周期性的加速度变化波形。设备内的算法通过分析这个波形的频率和振幅，就能识别出“一步”，从而实现计步。</li>
<li><strong>可实现的扩展功能:</strong><ul>
<li><strong>睡眠监测 :</strong> 通过长时间监测身体的微小动态和翻身次数，结合心率数据，可以分析用户的睡眠阶段（如浅睡、深睡、REM），并评估睡眠质量。</li>
<li><strong>跌倒检测 :</strong> 算法可以设定一个阈值，当检测到一个瞬时的高强度冲击（自由落体般的失重感），并且之后长时间静止不动时，可以判断为用户可能发生了跌倒，并触发警报。</li>
<li><strong>运动模式判断:</strong> 跑步、骑行、游泳等不同运动的加速度波形特征是完全不同的。通过机器学习算法，设备可以自动识别用户正在进行的运动类型，无需手动开启。（类似于Apple Health）</li>
<li><strong>敲击唤醒和交互:</strong> 可以识别用户敲击设备表盘的动作，用于点亮屏幕或执行快捷操作，提升交互体验。</li>
</ul>
</li>
</ul>
<h4 id="气压传感器"><a href="#气压传感器" class="headerlink" title="气压传感器"></a>气压传感器</h4><ul>
<li><strong>实现的基础功能:</strong> 爬楼高度统计。</li>
<li><strong>工作原理:</strong><br>  大气压强会随着海拔高度的上升而降低。气压传感器内部有一个极其敏感的柔性薄膜，它会随着外界气压的变化而发生形变。传感器测量这个形变的程度，并将其转换为精确的气压读数（单位通常是百帕 hPa）。<br>  当用户上楼时，海拔会发生微小但持续的上升，导致气压持续下降。算法捕捉到这种特定的气压变化模式，就能换算出用户攀爬的楼层数。</li>
<li><strong>可实现的扩展功能:</strong><ul>
<li><strong>海拔高度追踪:</strong> 在进行徒步、登山等户外运动时，可以精确记录总爬升高度和海拔变化曲线。</li>
<li><strong>天气变化预警:</strong> 在一个固定的地点，如果气压在短时间内急剧下降，通常预示着风暴天气即将来临。设备可以据此发出简单的天气预警。</li>
</ul>
</li>
</ul>
<h4 id="光电容积脉搏波-PPG-传感器"><a href="#光电容积脉搏波-PPG-传感器" class="headerlink" title="光电容积脉搏波 (PPG) 传感器"></a>光电容积脉搏波 (PPG) 传感器</h4><p>这是一个传感器系统，通常包含绿光、红光、红外光LED和光电二极管(Photodiode)。</p>
<ul>
<li><strong>实现的基础功能:</strong> 心率 (Heart Rate), 血氧饱和度 (SpO2), 血压趋势 (Blood Pressure Trend)。</li>
<li><strong>工作原理:</strong><ol>
<li><strong>基本原理:</strong> 传感器向手腕皮肤发射特定波长的光束。光束会穿透皮肤组织，一部分被血液、骨骼和组织吸收，另一部分被反射回来，由光电二极管接收。</li>
<li><strong>心率 (HR):</strong> 血液中的血红蛋白会吸收光线。每次心跳，手腕处的毛细血管会扩张，血流量增加，吸收的光也就越多，导致反射回来的光变少。这种有规律的反射光强度变化，就形成了脉搏波（PPG信号），这个波的频率就是你的心率。通常使用<strong>绿光LED</strong>测量心率，因为它对运动干扰的抵抗性较好。</li>
<li><strong>血氧 (SpO2):</strong> 这个过程需要<strong>红光</strong>和<strong>红外光</strong>两种LED。含氧血红蛋白和脱氧血红蛋白对这两种光的吸收率是不同的。通过测量这两种光被吸收的比例差异，设备就可以计算出血液中的氧气饱和度。</li>
<li><strong>血压 (BP):</strong> PPG传感器不能像医用袖带那样直接测量血压。它主要是通过分析PPG波形的特征（如波峰的形状、传播速度等）来<strong>估算血压的变化趋势</strong>。这是一个复杂的算法领域，通常需要结合大量数据进行校准，目前主要用于健康趋势追踪而非医疗诊断。</li>
</ol>
</li>
<li><strong>可实现的扩展功能:</strong><ul>
<li><strong>心率变异性 (HRV):</strong> 测量每次心跳之间微小的时间间隔差异。HRV是评估自主神经系统健康状况、压力水平、身体恢复程度的重要指标，是一个极具价值的健康功能。</li>
<li><strong>压力水平监测:</strong> 结合HRV数据和加速度数据，可以全天候、自动化地评估用户的生理压力水平。</li>
<li><strong>呼吸率 (Respiration Rate):</strong> 呼吸会引起胸腔起伏，从而对血液循环产生微弱的周期性影响。通过高级信号处理技术，可以从PPG信号中提取出这种微弱的调制，从而计算出呼吸频率。</li>
<li><strong>房颤风险提示 (Atrial Fibrillation Alert):</strong> 通过持续监测心跳节律是否规整，算法可以初步筛查心房颤动（一种常见的心律失常）的风险，并提醒用户咨询医生。（非医疗用途）</li>
</ul>
</li>
</ul>
<h3 id="初步物料规划与总结"><a href="#初步物料规划与总结" class="headerlink" title="初步物料规划与总结"></a>初步物料规划与总结</h3><p>下表是我对于此项目涉及物料型号的初步设想：</p>
<table>
<thead>
<tr>
<th align="left">阶段</th>
<th align="left">类别</th>
<th align="left">元件 (Component)</th>
<th align="left">功能描述</th>
<th align="left">选型理由</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>Demo阶段</strong><br><em>(目标：1个月内快速验证核心功能)</em></td>
<td align="left"><strong>核心控制与通信</strong></td>
<td align="left"><strong>Nordic nRF52840 模组</strong><br>(例如: 亿佰特 E73-2G4M08S1E)</td>
<td align="left"><strong>主控MCU</strong> + <strong>低功耗蓝牙5.x通信</strong>。负责运行所有代码、处理数据并与手机通信。</td>
<td align="left"><strong>超低功耗</strong>，是长续航的基础；强大的<strong>Cortex-M4F内核</strong>，能高效处理信号算法；<strong>成熟的SDK和社区</strong>，开发迅速；<strong>使用模组</strong>可规避射频设计风险。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><strong>运动传感</strong></td>
<td align="left"><strong>Bosch BMI270</strong><br>(六轴IMU)</td>
<td align="left"><strong>计步器</strong>，基础运动姿态识别。</td>
<td align="left"><strong>超低功耗</strong>，体积极小；<strong>自带计步器处理引擎</strong>，可分担主控MCU的计算压力，进一步省电。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><strong>生物传感</strong></td>
<td align="left"><strong>Maxim&#x2F;ADI MAX86150</strong><br>(PPG+ECG模拟前端)</td>
<td align="left"><strong>采集心率(HR)和血氧(SpO2)的PPG信号</strong>。</td>
<td align="left"><strong>高信噪比</strong>，这是解决毛发、深肤色等干扰问题的硬件基础；<strong>高度可配置</strong>，便于算法调试和优化；<strong>集成ECG</strong>，为后续升级预留了硬件空间。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><strong>环境传感</strong></td>
<td align="left"><strong>Bosch BMP390</strong><br>(气压计)</td>
<td align="left">测量大气压强，用于<strong>计算爬楼层数</strong>。</td>
<td align="left"><strong>高精度</strong>，能分辨细微的高度变化，确保楼层统计准确；<strong>功耗极低</strong>，易于集成。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong>后续扩展阶段</strong><br><em>(目标：丰富产品功能，提升竞争力)</em></td>
<td align="left"><strong>生物传感 (升级)</strong></td>
<td align="left"><strong>利用MAX86150的ECG功能</strong></td>
<td align="left">采集<strong>心电信号(ECG)<strong>，计算</strong>心率变异性(HRV)<strong>，用于</strong>压力等级评估</strong>。</td>
<td align="left"><strong>硬件已存在</strong>，此为软件和算法层面的重大升级；HRV是衡量健康和压力的重要指标，能极大提升产品价值；需配合外壳的<strong>电极设计</strong>。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><strong>体温传感</strong></td>
<td align="left"><strong>Maxim&#x2F;ADI MAX30205</strong></td>
<td align="left"><strong>测量皮肤温度</strong>，提供体温变化趋势。</td>
<td align="left"><strong>医用级精度</strong>；I2C接口，易于集成；功耗低，是现代健康追踪设备的标配功能。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><strong>用户交互</strong></td>
<td align="left"><strong>线性谐振执行器 (LRA)</strong> &#x2F;<br> <strong>偏心转子马达 (ERM)</strong></td>
<td align="left"><strong>振动提醒</strong>，用于消息通知、闹钟或健康预警。</td>
<td align="left">极大地提升用户体验，是智能穿戴设备必备的交互方式。LRA马达的振感更细腻。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><strong>高级传感 (可选)</strong></td>
<td align="left"><strong>MEMS 麦克风</strong></td>
<td align="left"><strong>语音指令</strong>，环境噪音监测。</td>
<td align="left">为未来的智能助手、通话或健康（如打鼾监测）功能提供硬件基础。需要MCU具备PDM&#x2F;I2S接口（nRF52840支持）。</td>
</tr>
</tbody></table>
<h2 id="供电与电池方案"><a href="#供电与电池方案" class="headerlink" title="供电与电池方案"></a>供电与电池方案</h2><p><strong>供电</strong>的设计和选型非常重要，尤其是对于内部空间本就受限的嵌入式可穿戴设备，在电池、电源管理系统、供电路径及布局方面都需要特别考量，以下是我对该项目供电设计方面的初期规划。</p>
<h3 id="电池选型"><a href="#电池选型" class="headerlink" title="电池选型"></a>电池选型</h3><p>作为空间极度受限的可穿戴设备，需要使用 <strong>高能量密度</strong>、<strong>形态灵活</strong>、<strong>重量轻</strong>的 <strong>锂聚合物电池</strong>。<br>对于聚合物电池的容量问题，我参考了市面上常见的可穿戴设备。对于大小与 <strong>普通手表</strong> 相近的可穿戴设备，它们的电池容量在250mAh - 400mAh之间，而对于需要更高便携性、更高集成度的<strong>手环类</strong>穿戴设备，它们的电池容量在50mAh - 150mAh之间。为了适应高续航、多功能和小体积的三重制约，我初步将电池容量假定在 <strong>200mAh</strong>，实际的电池选型也应位于这个数值上下，以保证兼顾设计需求。</p>
<h3 id="电源管理方案"><a href="#电源管理方案" class="headerlink" title="电源管理方案"></a>电源管理方案</h3><p>有了电池，我们还需要一个“大管家”来负责充电、放电保护和电压转换。使用分立元件（充电IC+LDO+DCDC）的传统方案会占用大量PCB面积，因此，<strong>高度集成的电源管理芯片 (PMIC)</strong> 是最佳选择。</p>
<ul>
<li><p><strong>方案：使用专为可穿戴设备设计的 PMIC，首选 Nordic nPM1100。</strong></p>
</li>
<li><p><strong>理由:</strong></p>
<ol>
<li><strong>高集成度，节省空间:</strong> nPM1100 在一块仅 <code>2.075 x 2.075 mm</code> 的芯片上，集成了<strong>线性充电器</strong>、<strong>高效降压转换器(Buck Converter)</strong> 和<strong>电池保护</strong>功能。这对于寸土寸金的手表PCB来说至关重要。</li>
<li><strong>高效率，延长续航:</strong> 相比于只能用LDO（线性稳压器）的简单方案，nPM1100 内置的高效Buck转换器可以将电池电压（3.0-4.2V）高效地转换为芯片需要的低电压（如1.8V或3.3V），转换效率可达90%以上，极大地减少了电量浪费。</li>
<li><strong>协同生态系统:</strong> nPM1100 是 Nordic 专门为 nRF52&#x2F;nRF53 系列设计的，两者协同工作可以达到最佳的功耗表现。</li>
<li><strong>为太阳能充电预留接口:</strong> PMIC通常支持多路电源输入，考虑到未来使用太阳能充电的需求，未来可以方便地将太阳能电池板作为另一路输入进行管理。</li>
</ol>
</li>
</ul>
<h3 id="电源树与电压轨设计"><a href="#电源树与电压轨设计" class="headerlink" title="电源树与电压轨设计"></a>电源树与电压轨设计</h3><p>电源树描述了电能从源头到各个用电元件的路径。一个清晰的电源树设计如下：</p>
<ol>
<li><p><strong>充电路径:</strong></p>
<ul>
<li>外部 <code>USB (5V)</code> -&gt; <code>PMIC (nPM1100)</code> -&gt; <code>3.7V Li-Po 电池</code></li>
</ul>
</li>
<li><p><strong>供电路径:</strong></p>
<ul>
<li><code>3.7V Li-Po 电池</code> -&gt; <code>PMIC (nPM1100)</code> -&gt; 高效Buck转换器 -&gt; 输出 <strong><code>1.8V</code></strong> 的主系统电压 **(VSYS)**。<ul>
<li><strong><code>VSYS (1.8V)</code></strong> 直接供给 <strong>nRF52840</strong> 的主电源。nRF52840可以在1.8V下全功能运行，电压越低，功耗越低。</li>
</ul>
</li>
<li><code>VSYS (1.8V)</code> -&gt; <strong>一颗小型的升压转换器 (Boost Converter)</strong> -&gt; 输出 <strong><code>3.3V</code></strong> 的传感器电压 **(VSEN)**。<ul>
<li><strong><code>VSEN (3.3V)</code></strong> 供给 <strong>BMI270</strong>, <strong>BMP390</strong>, <strong>MAX86150</strong> 等需要较高电压的传感器。</li>
</ul>
</li>
<li><strong>PPG LED供电:</strong> MAX86150 内部集成了独立的LED驱动器，可以直接由电池供电，以提供足够大的驱动电流，无需外部额外处理。</li>
</ul>
</li>
</ol>
<blockquote>
<p>1.8V的<code>VSYS</code>主系统电压是现代低功耗设计的核心思想。让核心处理器运行在尽可能低的电压下，可以极大地降低动态功耗。而传感器需要较高电压时，再通过一个高效的Boost“按需升压”，从而实现整个系统的功耗最优化。</p>
</blockquote>
<h3 id="功耗估算与续航分析"><a href="#功耗估算与续航分析" class="headerlink" title="功耗估算与续航分析"></a>功耗估算与续航分析</h3><p><strong>假设:</strong></p>
<ul>
<li>电池容量: <strong>150mAh</strong></li>
<li>工作周期: 60秒</li>
<li><strong>活动状态 (2秒):</strong> MCU唤醒，所有传感器采集数据，BLE传输数据。<ul>
<li>估算平均电流: <strong>~12mA</strong> (这是一个比较保守的高值)</li>
</ul>
</li>
<li><strong>睡眠状态 (58秒):</strong> nRF52840进入System ON的深度睡眠模式，仅RTC运行。<ul>
<li>估算平均电流: <strong>~5µA</strong> (0.005mA) (nRF52840可以做到更低)</li>
</ul>
</li>
</ul>
<p><strong>计算平均电流:</strong></p>
<p><img src="/images/post-20251014/image.png" alt="1"><br><img src="/images/post-20251014/image-1.png" alt="2"></p>
<p><strong>计算理论续航时间:</strong></p>
<p><img src="/images/post-20251014/image-2.png" alt="3"></p>
<p><strong>结论:</strong><br>即使在比较保守的电流估算下，采用<strong>150mAh的锂聚合物电池</strong>，配合以<strong>Nordic nPM1100为核心的高效PMIC</strong>和优化的电源树设计，实现<strong>超过5天（理论可达15天）</strong>的续航目标是<strong>完全可行</strong>的。这个估算为我们的方案提供了强有力的数据支撑。</p>
<h2 id="关键：解决毛发遮挡问题"><a href="#关键：解决毛发遮挡问题" class="headerlink" title="关键：解决毛发遮挡问题"></a>关键：解决毛发遮挡问题</h2><p>对于不同人群，佩戴此设备部位的毛发量存在较大差异，在与研发团队的探讨中，解决毛发造成的信号和测量干扰问题成为了设计的关键，下面，我将从</p>
<ul>
<li>毛发密集区域对测量造成的干扰</li>
<li>物理设计方面的解决方案</li>
<li>电路选型、PCB Layout方面解决方案</li>
<li>数字信号处理方向的最终优化</li>
</ul>
<p>几个方面来展开探讨毛发的影响和解决思路。</p>
<h3 id="毛发遮挡带来的问题"><a href="#毛发遮挡带来的问题" class="headerlink" title="毛发遮挡带来的问题"></a>毛发遮挡带来的问题</h3><p>在寻找解决方式之前，首先需要客观的分析毛发对这种光电容积脉搏波（PPG）技术测量结果造成的影响。如上文的技术阐释所说，这种传感器的测量核心依赖是脉搏造成的皮下毛细血管血液容量的微小变化，而毛发和毛囊（尤其是深色毛发），总的来说，会造成整个测量的信噪比（SNR）的急剧下降。</p>
<p>毛发会在物理和光学层面主要造成下面的两个问题，每个问题又会在信号采集层面造成如下的影响：</p>
<ol>
<li><strong>光吸收与散射:</strong> 毛发和毛囊会大量吸收和散射传感器发出的光。这导致两个严重问题：<ul>
<li><strong>直流(DC)分量减弱:</strong> 总反射回光电二极管（PD）的光强度（即DC信号）大幅降低。</li>
<li><strong>交流(AC)分量淹没:</strong> 我们真正关心的、由心跳引起的微弱搏动信号（AC信号）相对于DC信号本来就很小（通常只有1-2%）。当DC信号本身就因遮挡而很弱时，AC信号就更容易被各种噪声（电路噪声、运动噪声）所淹没。</li>
</ul>
</li>
<li><strong>光学耦合不佳:</strong> 毛发在传感器和皮肤之间形成了一个间隙，降低了光学耦合效率，并可能让环境光从侧面漏入，进一步干扰测量。</li>
</ol>
<p>因此，我们所有努力的核心目标，都是在这些不利条件下，<strong>最大限度地提升PPG信号的信噪比</strong>。</p>
<h3 id="从多个层面的解决思路"><a href="#从多个层面的解决思路" class="headerlink" title="从多个层面的解决思路"></a>从多个层面的解决思路</h3><p>毛发干扰，归根结底会严重降低信噪比。考虑到这个因素取决于硬件的诸多物理特性和软件的后续滤波和数据计算，单一的方法无法根治这个问题。我们必须从 <strong>多个层面</strong> 实现协同设计。</p>
<p>我参考了一些与之相关的项目和论文，将按照以下三个主要方面进行展开论述。</p>
<h4 id="物理与结构设计：优化光路"><a href="#物理与结构设计：优化光路" class="headerlink" title="物理与结构设计：优化光路"></a>物理与结构设计：优化光路</h4><p>这是最直接、最基础的层面，目标是创造一个最佳的测量环境。</p>
<ul>
<li><p><strong>增加恒定的接触压力:</strong></p>
<ul>
<li><strong>论证:</strong> 合理的机械设计，例如采用有一定弧度的表背和弹性的表带，可以确保传感器模组与皮肤保持紧密、恒定的贴合。根据多篇关于PPG信号质量的研究（例如，一些发表在<em>IEEE Sensors Journal</em>上的论文），适度的压力可以暂时性地压平或拨开毛发，并排挤出一部分组织液，让传感器更接近毛细血管，从而显著增强信号质量。</li>
<li><strong>方案:</strong> 设计产品外壳时，在传感器模组周围增加一圈微凸的环形结构，确保佩戴时能集中压力在传感区域。</li>
</ul>
</li>
<li><p><strong>优化光学隔离:</strong></p>
<ul>
<li><strong>论证:</strong> 必须严格防止LED发出的光在未进入皮肤组织的情况下就直接“泄露”到光电二极管上，这个现象称为光学串扰 （Optical Crosstalk）。在毛发区域，光线更容易在皮肤表面发生漫反射，加剧串扰。MAX86150等光电传感器的数据手册对此做了严谨的规定，以保证在安装的过程中避免这种串扰现象的产生。</li>
<li><strong>方案:</strong> 在PCB设计和外壳结构上，必须在LED和光电二极管之间设计一个物理性的光学隔离带。通常使用黑色的泡棉、硅胶或塑料结构来实现，这是专业穿戴设备设计的标准做法。</li>
</ul>
</li>
</ul>
<h4 id="光学与硬件设计-增强信号源头"><a href="#光学与硬件设计-增强信号源头" class="headerlink" title="光学与硬件设计: 增强信号源头"></a>光学与硬件设计: 增强信号源头</h4><p>当物理条件优化后，我们需要从硬件本身获取最强的原始信号。这个优化方案在信号源层面增强了DC分量，同时使AC分量的有效值更为凸显。</p>
<ul>
<li><p><strong>动态调整LED驱动电流:</strong></p>
<ul>
<li><strong>论证:</strong> 专业AFE芯片（如MAX86150）允许通过I2C动态配置LED的驱动电流。这为我们实现一个闭环控制系统提供了可能。</li>
<li><strong>方案:</strong> 在固件中设计一个算法。在每次测量前，首先用一个较小的电流点亮LED，测量反射光的DC强度。如果DC强度低于某个阈值（这表明光学耦合很差，很可能遇到了毛发或深肤色），MCU可以立即通过I2C指令，提高LED的驱动电流，用更强的光 <strong>“穿透”干扰层</strong> 。待信号稳定后，再恢复到正常电流以节省功耗。</li>
</ul>
</li>
<li><p><strong>多波长&#x2F;多通道传感:</strong></p>
<ul>
<li><strong>论证:</strong> 相关研究表明，不同波长的光（如绿光、红光、红外光）在皮肤中的穿透深度和对运动的敏感度各不相同。例如，绿光（<del>530nm）对运动干扰的鲁棒性最好，但穿透浅；红外光（</del>940nm）穿透深，但对运动敏感。同时使用多个光电二极管接收信号，可以从不同位置捕获信号，总有一个位置的信号质量会更好。</li>
<li><strong>方案:</strong><ol>
<li><strong>硬件层面:</strong> 选用支持多通道同步采样的AFE芯片。</li>
<li><strong>算法层面:</strong> 算法可以融合来自不同波长或不同PD通道的数据，或者根据**信号质量指数(SQI)**动态选择当前质量最好的那个通道的数据进行分析。</li>
</ol>
</li>
</ul>
</li>
</ul>
<h4 id="信号处理与算法-提纯微弱信号"><a href="#信号处理与算法-提纯微弱信号" class="headerlink" title="信号处理与算法: 提纯微弱信号"></a>信号处理与算法: 提纯微弱信号</h4><p>这是最后，也是最关键的一道防线。此时我们拿到的是一个可能依然被噪声污染的信号，需要用算法进行提纯。</p>
<ul>
<li><p><strong>运动伪影去除 (Motion Artifact Removal - MAR):</strong></p>
<ul>
<li><strong>论证:</strong> 手臂的运动是PPG信号最大的噪声源，其影响甚至超过毛发。学术界和工业界投入了大量精力研究MAR算法。目前最主流和有效的方法是<strong>利用加速度传感器的数据作为噪声参考</strong>，通过<strong>自适应滤波 (Adaptive Filtering)</strong> 技术来消除运动噪声。</li>
<li><strong>方案:</strong> 采集PPG信号的同时，同步采集三轴加速度计的数据。实现一个<strong>LMS (Least Mean Squares) 或 RLS (Recursive Least Squares) 自适应滤波器</strong>。该滤波器能够“学习”到加速度信号（运动）和PPG信号中噪声部分的相关性，然后从原始PPG信号中“减去”这部分运动伪影，从而提纯出真实的心率搏动波形。这是保证在日常活动中测量准确性的核心技术。</li>
</ul>
</li>
<li><p><strong>信号质量评估 (Signal Quality Index - SQI):</strong></p>
<ul>
<li><strong>论证:</strong> 与其处理一个完全无法挽救的坏信号，不如直接识别并丢弃它。SQI算法就是这个“质检员”。</li>
<li><strong>方案:</strong> 在计算心率、血氧等参数之前，先对每一段（例如2-5秒）的PPG波形进行质量打分。评估指标可以包括：<strong>信号的周期性、波形与标准脉搏波形的相似度、信号的能量分布</strong>等。只有当SQI分数高于预设阈值时，才认为这段数据有效并进行后续计算。这可以有效避免出现离谱的错误读数。</li>
</ul>
</li>
</ul>
<h3 id="实施与验证路径"><a href="#实施与验证路径" class="headerlink" title="实施与验证路径"></a>实施与验证路径</h3><ol>
<li><strong>阶段一 (硬件):</strong> 基于以上思路，完成采用<strong>高信噪比AFE (如MAX86150)<strong>、并带有</strong>良好光学隔离结构</strong>的原型板设计。</li>
<li><strong>阶段二 (数据采集):</strong> 招募一个包含不同肤色、不同手臂毛发密度的测试小组，采集同步的PPG和三轴加速度数据，建立我们自己的信号数据库。</li>
<li><strong>阶段三 (算法研发):</strong> 在MATLAB或Python中，使用采集到的数据，对上述的MAR和SQI算法进行开发、调试和验证。</li>
<li><strong>阶段四 (固件移植):</strong> 将验证有效的算法用C语言实现，并移植到nRF52芯片上，进行实机测试和优化。</li>
</ol>
<p><strong>总结:</strong> 解决毛发干扰问题，绝非单一技术可以实现，它是一个典型的系统工程。我们需要通过 <strong>物理结构优化 → 硬件动态自适应 → 软件算法提纯</strong> 这样一套组合拳，层层递进，才能在各种挑战性场景下，获得稳定、可靠的人体生理数据。</p>
<h2 id="产品设计周期和规划"><a href="#产品设计周期和规划" class="headerlink" title="产品设计周期和规划"></a>产品设计周期和规划</h2><p>进行了技术分析之后，我需要对产品的设计周期产生一个初步的规划，这个规划结合了我与研发团队的第一次初步沟通获得的信息，以及我对整个产品所涉及的设计流程进行的调研结果。我将整个产品的设计规划大致分为三个阶段，这是现代科技产品的开发较为常见的迭代验证和测试方法。</p>
<p><strong>第一阶段：概念设计</strong></p>
<ul>
<li><strong>目标</strong>：确定产品的定位，确定整体设计方向和核心功能规格，最终确定”我们需要做什么“。</li>
<li><strong>主要工作</strong>：<ul>
<li>进行市场研究，确定面向的用户群体</li>
<li>绘制设计草图，确定产品的目标形态（必要时，可通过3D打印设计手板模型，有助于更好的形态选择）</li>
<li>分析功能需求，将功能、性能指标、设计约束和标准以文档形式呈现。</li>
</ul>
</li>
<li><strong>阶段交付成果</strong>：<ul>
<li>产品的初步外观设计图</li>
<li>产品需求文档（作为后续项目指导纲要、项目组一致审核通过）</li>
</ul>
</li>
</ul>
<p><strong>第二阶段：工程验证</strong></p>
<ul>
<li><strong>目标</strong>：验证工程可行性，实现基础系统和数据采集 -&gt; 处理 -&gt; 传输通路，从零开始设计与调试软件驱动及信号处理算法</li>
<li><strong>主要工作</strong>：<ul>
<li>根据产品需求决定最终芯片及物料选型</li>
<li>执行 Schematic &#x2F; PCB 设计，此电路板作为项目的原型测试板，预留数据传输和调试接口</li>
<li>PCB打样、焊接、电路调试，保证芯片可以启动，各个元件可以工作，电路连通。</li>
<li>开发基础固件和算法，保证数据可以通畅上传到上位机，运动和生物学基础数据可以从原始数据中高保真的解析</li>
</ul>
</li>
<li><strong>阶段交付成果</strong>：<ul>
<li>原型电路板</li>
<li>功能演示</li>
<li>含有详细硬件指标（电源，功耗，数据链路传输）的技术测试报告</li>
</ul>
</li>
<li><strong>预期时间</strong>：1个月</li>
</ul>
<p><strong>第三阶段：设计验证</strong><br><strong>概述</strong>：这一阶段主要将上述设计的原型电路进行优化，比如缩小PCB体积，重新排列元器件和设计最终版本的外壳，测试产品可量产性、工作性能和可靠性，最终投入量产和商业化阶段。</p>
<p>这几个阶段是循序渐进且迭代验证的，保证了产品开发的顺利和稳定，可以避免开发过程中的分歧与失误。其中，原型电路与固件开发验证是本项目最具挑战的部分，也是前文内容的规划所在。</p>
<h2 id="关于未来设计——太阳能电池的思考"><a href="#关于未来设计——太阳能电池的思考" class="headerlink" title="关于未来设计——太阳能电池的思考"></a>关于未来设计——太阳能电池的思考</h2><p>在有限空间内集成太阳能充电，其目标不是“快速充满”，而是通过“涓流充电”显著延长电池的续航时间。实现这一功能，需从以下三方面进行规划：</p>
<ul>
<li><p><strong>1. 太阳能电池板技术选型：</strong><br>  必须选用在<strong>室内弱光和漫射光</strong>下依然能高效发电的电池技术。传统的单晶硅不适合此场景。应重点考察：</p>
<ul>
<li><strong>柔性光伏电池（如OPV, 钙钛矿）：</strong> 这类技术可弯曲，适合集成到<strong>表带</strong>上，以获取最大的受光面积。</li>
<li><strong>半透明光伏电池：</strong> 可叠层于设备屏幕之上（若有屏幕），是空间利用率最高的方案，但技术复杂且成本高。</li>
<li><strong>表圈集成：</strong> 将高效太阳能电池切割并集成到表盘周边的<strong>表圈</strong>上（如Garmin Fenix系列的做法）。</li>
</ul>
</li>
<li><p><strong>2. 专用的电源管理电路 (PMIC)：</strong><br>  原有的PMIC（如nPM1100）可能不足以支持。必须引入支持<strong>能量收集 (Energy Harvesting)</strong> 的专用PMIC。</p>
<ul>
<li>该PMIC需具备<strong>超低静态功耗</strong>（纳安级别）和<strong>最大功率点跟踪 (MPPT)</strong> 功能。</li>
<li>MPPT功能至关重要，它能实时“榨取”太阳能电池在不同光照条件下所能输出的最大功率，效率远高于简单的线性充电。</li>
</ul>
</li>
<li><p><strong>3. 空间与结构集成：</strong></p>
<ul>
<li><strong>方案A (表带集成)：</strong> 将柔性太阳能电池嵌入表带。这是获取最大采光面积的方案，但挑战在于需要设计一条极其耐用、耐弯折的柔性电路（FPC）将电能从表带传输到手表主体。</li>
<li><strong>方案B (表圈集成)：</strong> 空间受限，但技术相对成熟，结构可靠性高。这对工业设计提出了很高的要求，需要将电池与表圈结构一体化设计。</li>
<li>两种方案都需要与结构工程师紧密协作，在设计初期就预留出电池、PMIC以及相应连接器的空间。</li>
</ul>
</li>
</ul>
<p>综上所述，太阳能电池在智能穿戴设备中的集成是可行的，但是对于空间严重受限的手环、手表等设备，技术难度将会显著提高。相比于一些在常规尺寸电路板（甚至是分立的电源供电电路）上采用的电源管理+能量收集的方案，在手表中集成这一创新设计面临着元件重新选型、材料限制、成本控制等问题，这是一个需要集思广益与共同研发的前瞻性课题。</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>这篇调研和规划仍具有许多不足之处，希望老师与团队负责人提出宝贵意见！</p>
<h1 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><ol>
<li>Quantifying the Impact of Hair and Skin Characteristics on fNIRS Signal Quality for Enhanced Inclusivity — M. A. Yücel et al., 2024</li>
<li>A preliminary exploration of hair color, hair cleanliness, light and their effects on fNIRS signals — M. Holmes et al., 2024</li>
<li>Remote photoplethysmography with a high-speed camera reveals temporal and amplitude differences between glabrous and non-glabrous skin — M. Cao et al., Sensors, 2023</li>
</ol>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://snowmiku-home.top">Snowmiku</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://snowmiku-home.top/2025/10/14/post-20251014/">http://snowmiku-home.top/2025/10/14/post-20251014/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://snowmiku-home.top" target="_blank">葱酱的幻想乡 - Snowmiku's Dreamland</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/IoT/">IoT</a><a class="post-meta__tags" href="/tags/BLE/">BLE</a><a class="post-meta__tags" href="/tags/nRF52/">nRF52</a><a class="post-meta__tags" href="/tags/Smart-Wear/">Smart Wear</a></div><div class="post_share"><div class="social-share" data-image="/images/icon2.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>赞助</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/images/qr_w.jpg" target="_blank"><img class="post-qr-code-img" src="/images/qr_w.jpg" alt="微信赞赏码"/></a><div class="post-qr-code-desc">微信赞赏码</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2025/08/19/post-2025819/" title="【Hexo】适用于静态博客的无障碍AI朗读插件部署程序（开源）"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">【Hexo】适用于静态博客的无障碍AI朗读插件部署程序（开源）</div></div></a></div></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/images/icon2.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Snowmiku</div><div class="author-info__description">一个水贴和存放心情的角落罢了。<br/>记得要开心呀！</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">34</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/18650official"><i class="fab fa-github"></i><span>GitHub</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://t.me/mmmiku_18650" target="_blank" title="Telegram"><i class="fab fa-telegram"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">最近一次维护于 2024/9/13</br>以后的更新可以在更多信息-更新日志中查看</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%86%99%E5%9C%A8%E5%89%8D%E9%9D%A2"><span class="toc-text">写在前面</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90"><span class="toc-text">需求分析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E4%BA%A7%E5%93%81%E6%A6%82%E8%BF%B0"><span class="toc-text">项目产品概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A0%94%E7%A9%B6%E7%9A%84%E9%87%8D%E7%82%B9"><span class="toc-text">研究的重点</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%86%E8%8A%82%E6%80%9D%E8%80%83%EF%BC%9A%E5%AF%B9%E7%A0%94%E7%A9%B6%E9%87%8D%E7%82%B9%E7%9A%84%E5%B1%95%E5%BC%80"><span class="toc-text">细节思考：对研究重点的展开</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8A%AF%E7%89%87%E3%80%81%E9%80%9A%E8%AE%AF%E6%96%B9%E6%A1%88"><span class="toc-text">芯片、通讯方案</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%A0%E6%84%9F%E5%99%A8%E6%96%B9%E6%A1%88"><span class="toc-text">传感器方案</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%A0%E6%84%9F%E5%99%A8%E5%B8%82%E5%9C%BA%E5%88%86%E6%9E%90%E5%92%8C%E5%88%9D%E6%AD%A5%E9%80%89%E5%9E%8B"><span class="toc-text">传感器市场分析和初步选型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%A0%E6%84%9F%E5%99%A8%E7%9A%84%E6%8B%93%E5%B1%95%E5%8A%9F%E8%83%BD"><span class="toc-text">传感器的拓展功能</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E8%BD%B4%E5%8A%A0%E9%80%9F%E5%BA%A6%E4%BC%A0%E6%84%9F%E5%99%A8"><span class="toc-text">3轴加速度传感器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B0%94%E5%8E%8B%E4%BC%A0%E6%84%9F%E5%99%A8"><span class="toc-text">气压传感器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%89%E7%94%B5%E5%AE%B9%E7%A7%AF%E8%84%89%E6%90%8F%E6%B3%A2-PPG-%E4%BC%A0%E6%84%9F%E5%99%A8"><span class="toc-text">光电容积脉搏波 (PPG) 传感器</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9D%E6%AD%A5%E7%89%A9%E6%96%99%E8%A7%84%E5%88%92%E4%B8%8E%E6%80%BB%E7%BB%93"><span class="toc-text">初步物料规划与总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BE%9B%E7%94%B5%E4%B8%8E%E7%94%B5%E6%B1%A0%E6%96%B9%E6%A1%88"><span class="toc-text">供电与电池方案</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%B5%E6%B1%A0%E9%80%89%E5%9E%8B"><span class="toc-text">电池选型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%B5%E6%BA%90%E7%AE%A1%E7%90%86%E6%96%B9%E6%A1%88"><span class="toc-text">电源管理方案</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%B5%E6%BA%90%E6%A0%91%E4%B8%8E%E7%94%B5%E5%8E%8B%E8%BD%A8%E8%AE%BE%E8%AE%A1"><span class="toc-text">电源树与电压轨设计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%9F%E8%80%97%E4%BC%B0%E7%AE%97%E4%B8%8E%E7%BB%AD%E8%88%AA%E5%88%86%E6%9E%90"><span class="toc-text">功耗估算与续航分析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%EF%BC%9A%E8%A7%A3%E5%86%B3%E6%AF%9B%E5%8F%91%E9%81%AE%E6%8C%A1%E9%97%AE%E9%A2%98"><span class="toc-text">关键：解决毛发遮挡问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AF%9B%E5%8F%91%E9%81%AE%E6%8C%A1%E5%B8%A6%E6%9D%A5%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-text">毛发遮挡带来的问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8E%E5%A4%9A%E4%B8%AA%E5%B1%82%E9%9D%A2%E7%9A%84%E8%A7%A3%E5%86%B3%E6%80%9D%E8%B7%AF"><span class="toc-text">从多个层面的解决思路</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%A9%E7%90%86%E4%B8%8E%E7%BB%93%E6%9E%84%E8%AE%BE%E8%AE%A1%EF%BC%9A%E4%BC%98%E5%8C%96%E5%85%89%E8%B7%AF"><span class="toc-text">物理与结构设计：优化光路</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%89%E5%AD%A6%E4%B8%8E%E7%A1%AC%E4%BB%B6%E8%AE%BE%E8%AE%A1-%E5%A2%9E%E5%BC%BA%E4%BF%A1%E5%8F%B7%E6%BA%90%E5%A4%B4"><span class="toc-text">光学与硬件设计: 增强信号源头</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86%E4%B8%8E%E7%AE%97%E6%B3%95-%E6%8F%90%E7%BA%AF%E5%BE%AE%E5%BC%B1%E4%BF%A1%E5%8F%B7"><span class="toc-text">信号处理与算法: 提纯微弱信号</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E6%96%BD%E4%B8%8E%E9%AA%8C%E8%AF%81%E8%B7%AF%E5%BE%84"><span class="toc-text">实施与验证路径</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%A7%E5%93%81%E8%AE%BE%E8%AE%A1%E5%91%A8%E6%9C%9F%E5%92%8C%E8%A7%84%E5%88%92"><span class="toc-text">产品设计周期和规划</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E%E6%9C%AA%E6%9D%A5%E8%AE%BE%E8%AE%A1%E2%80%94%E2%80%94%E5%A4%AA%E9%98%B3%E8%83%BD%E7%94%B5%E6%B1%A0%E7%9A%84%E6%80%9D%E8%80%83"><span class="toc-text">关于未来设计——太阳能电池的思考</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-text">总结</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE"><span class="toc-text">参考文献</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/14/post-20251014/" title="关于智能可穿戴设备研究计划的初步设想">关于智能可穿戴设备研究计划的初步设想</a><time datetime="2025-10-14T10:06:32.000Z" title="发表于 2025-10-14 18:06:32">2025-10-14</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/08/19/post-2025819/" title="【Hexo】适用于静态博客的无障碍AI朗读插件部署程序（开源）">【Hexo】适用于静态博客的无障碍AI朗读插件部署程序（开源）</a><time datetime="2025-08-18T16:11:09.000Z" title="发表于 2025-08-19 00:11:09">2025-08-19</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/08/15/post-2025816/" title="【国赛总结】基于瑞萨电子RA6M5的智能导引系统（开源）">【国赛总结】基于瑞萨电子RA6M5的智能导引系统（开源）</a><time datetime="2025-08-15T14:50:35.000Z" title="发表于 2025-08-15 22:50:35">2025-08-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/06/16/post-2025616/" title="【教程】使用树莓派和CUPS部署远程打印服务">【教程】使用树莓派和CUPS部署远程打印服务</a><time datetime="2025-06-16T12:25:08.000Z" title="发表于 2025-06-16 20:25:08">2025-06-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/09/17/post-2024917/" title="【AList】解决上传大文件返回错误413问题">【AList】解决上传大文件返回错误413问题</a><time datetime="2024-09-17T09:00:13.000Z" title="发表于 2024-09-17 17:00:13">2024-09-17</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By Snowmiku</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>(() => {
  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://my-twikoo-steel.vercel.app/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://my-twikoo-steel.vercel.app/',
      region: '',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))

    GLOBAL_CONFIG_SITE.isPost && getCount()
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(init,0)
    else getScript('https://cdn.jsdelivr.net/npm/twikoo@1.6.31/dist/twikoo.all.min.js').then(init)
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><canvas id="universe"></canvas><script src="/js/universe.js"></script><div class="aplayer no-destroy" data-id="6614644804" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="false" data-lrcType="-1"> </div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-nest.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/click-heart.min.js" async="async" mobile="true"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/metingjs/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener
  btf.removeGlobalFnEvent('pjax')
  btf.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/miku.model.json"},"display":{"position":"right","width":100,"height":200},"mobile":{"show":true},"react":{"opacity":0.7},"log":false});</script></body></html>